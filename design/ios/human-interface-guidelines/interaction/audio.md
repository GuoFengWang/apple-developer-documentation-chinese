#音频

音频无论是作为你应用的主要体验方面或者其中的一个功能，你都需要了解人们对声音表现的期望和如何满足这些期望。

用户通过音量键按钮，静音开关，耳机控制和屏幕上的音量条来控制声音。许多第三方配件也包括控制声音。音频可以通过内部或外部扬声器，耳机输出，甚至可以无线地通过启用 AirPlay 或蓝牙设备输出。

* 静音。人们可以将设备切换为静音来避免被其他的声音打扰，比如闹铃和信息铃声。他们还希望禁用不必要的声音，包括键盘的声音，声音效果，游戏配乐，和其他听觉反馈。当设备设置为静音后，只有明确指定的声音会响起，比如在使用多媒体播放时的音频，警报和音频/视频通讯消息。

* 音量。无论是使用设备上的物理按键还是屏幕上的音量滑动条，人们都希望能通过调节手机音量大小可使得整体声音系统都有效，包括音乐和应用程序内的音效。唯一的例外是铃声音量，当音频处于非播放状态时，它始终是单独调整的。

* 耳机。人们可以通过使用耳机来接听一些私密的声音并且释放了他们的双手。当插入耳机时，用户期望的声音会不间断地自动重新路由。当拔掉耳机，他们希望立即暂停播放。

**必要时会自动调整音量大小，但不是整体音量。**你的应用可以调整相对的，独立的音量大小来达到一个非常不错的混音效果。然而，最终的输出应该始终是由系统音量来管理的。

**允许在适当的时候改变音频输出。**人们通常会想要选择不同的音频输出设备。例如，他们可能想要通过他们的客厅音响，车载收音机，或者 Apple TV 来听音乐。除非有令人信服的理由，否则都会支持此功能。

**使用系统提供的音频视图来允许用户调节音频。**要提供用于调整音频的控制接口最好的方法是使用音频视图。这种界面是可定制的，包括音量级别滑块，甚至包括对重定向控制音频输出的控制。实现细节，请参阅 [MPVolumeView](https://developer.apple.com/reference/mediaplayer/mpvolumeview) 。

**使用系统的声音服务来实现短声音和振动。**实现细节，请参阅 [System Sound Services](https://developer.apple.com/reference/audiotoolbox/system_sound_services) 。

**如果声音对您的应用程序至关重要，请对音频进行分类。**不同的音频类别允许声音被静音通过静音开关，与其他音频混合，或者在您的应用程序后台运行时播放。应根据类别的含义和设备当前的音频需求状态来选择类别，并将其分配给你的音频会话。例如，用户切换另一个应用程序时不要暂停音乐，如果你不需要的话。一般来说，在应用程序运行时最好避免更改类别，但在不同时间录制和播放音频的应用程序除外。有关实现细节，请参见  [Audio Session Programming Guide](https://developer.apple.com/library/content/documentation/Audio/Conceptual/AudioSessionProgrammingGuide/Introduction/Introduction.html) 。



|类别 |含义|表现 
|---  |---| -----  |         
|**Solo ambient**|声音不是必须的，但它会使其他音频静音。例如，一个带配乐的游戏。|支持静音开关响应。不支持混音。不支持后台播放。
**Ambient**      | 声音不是必须的，不会使其他音频静音。例如，一个允许用户在玩游戏时可以从另一个应用播放音乐来代替游戏音轨的游戏。 |  支持静音开关响应。支持混音。不支持后台播放。
**Playback** 		| 声音是必要的，可以与其他音频混合。例如，一本外语学习的有声读物或教育类的 app 用户在使用一个学习外语的有声读物或教育应用时，人们可能在切换应用后台后，也想要继续收听。|  不支持静音开关响应。支持/不支持混音。支持后台播放。
**Record** 		| 声音被录制。例如，一个笔记型应用程序会提供录音模式。这种类型的应用可以切换它的 category 为 playback，如果它允许人们播放已经记录的笔记。|  不支持静音开关响应。不支持混音。支持后台播放。
**Play and record**	 | 可能同时录音和播放。例如，音频消息或视频呼叫应用程序。|  不支持静音开关响应。支持/不支持混音。支持后台播放。


**当中断发生后，在恰当的时间恢复音频播放。**有时候，当前播放的音频会被来自不同应用程序的音频中断。临时的打断例如呼入的电话是被认为是可恢复的。永久性的中断，如音乐播放时呼叫 Siri 时，是被认为是不可恢复的。当可恢复的中断发生时，如果当前音频处于播放状态，应用程序应当在中断结束后恢复播放。例如，一个正在播放的配乐音效的游戏和一个正在播放音频的媒体程序都应该恢复。当应用没有在播放状态时，即使中断发生也不需要恢复。

**让其他应用程序知道当你的应用程序完成播放临时音频。**如果您的应用程序可能暂时中断其他应用程序的音频，它应该适当地标记音频会话以便当其他应用程序可以安全的恢复时得到通知。详细细节，请查阅  [AVFoundation](https://developer.apple.com/reference/avfoundation) 中的 [avaudiosessionsetactiveoptionnotifyothersondeactivation](https://developer.apple.com/reference/avfoundation/avaudiosessionsetactiveoptions/avaudiosessionsetactiveoptionnotifyothersondeactivation) 。

**只有当它有意义时才响应音频控件。**不管你的应用程序是在前台还是后台，人们都可以从你的应用程序界面外部控制音频播放，比如在控制中心或他们耳机上的线控。如果你的应用程序正在播放音频在一段清晰的音频相关的上下文中，或连接到一个支持 AirPlay 的设备，则可以相应音频控制。否则，当另一个应用程序的音频可能被控制激活和播放的时候，你的应用程序不应该停止它。

**不要将音频控件使用在其他用途。**人们期望音频控件在所有应用程序中表现一致。永远不要重新定义音频控件的含义。如果你的应用程序不支持某些控件，那么它根本不应该对它们进行响应。

